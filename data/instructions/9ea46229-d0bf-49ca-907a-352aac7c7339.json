{
  "id": "9ea46229-d0bf-49ca-907a-352aac7c7339",
  "function_name": "batch_processor",
  "requirements": {
    "input": {
      "description": "複数の命令書を一括処理するためのパラメータ",
      "parameters": [
        {
          "name": "instruction_ids",
          "type": "List[str]",
          "description": "処理対象の命令書IDリスト",
          "required": true,
          "default": null
        },
        {
          "name": "operation",
          "type": "str",
          "description": "実行する操作（execute, validate, approve等）",
          "required": true,
          "default": null
        },
        {
          "name": "parallel",
          "type": "bool",
          "description": "並列処理を行うかどうか",
          "required": false,
          "default": true
        }
      ]
    },
    "output": {
      "description": "バッチ処理結果の詳細レポート",
      "type": "dict",
      "format": "{'success': int, 'failed': int, 'details': List[dict], 'total_time': float}",
      "example": "{'success': 5, 'failed': 1, 'details': [...], 'total_time': 12.34}"
    },
    "validation": {
      "input_validation": [
        "instruction_idsは空ではないリストであること",
        "operationは有効な操作名であること",
        "各instruction_idが存在し、アクセス可能であること"
      ],
      "output_validation": [
        "結果にはsuccess, failed, details, total_timeが含まれること",
        "detailsには各命令書の処理結果が含まれること"
      ]
    },
    "error_handling": {
      "expected_errors": [
        {
          "error_type": "InstructionNotFoundError",
          "condition": "指定された命令書IDが存在しない場合",
          "message": "命令書 {id} が見つかりません"
        },
        {
          "error_type": "InvalidOperationError",
          "condition": "無効な操作名が指定された場合",
          "message": "操作 '{operation}' はサポートされていません"
        },
        {
          "error_type": "BatchProcessingError",
          "condition": "バッチ処理中に予期しないエラーが発生した場合",
          "message": "バッチ処理エラー: {details}"
        }
      ],
      "logging": "各命令書の処理結果、エラー詳細、処理時間を記録、DEBUGレベルで進捗状況をログ出力"
    },
    "dependencies": [
      "concurrent.futures",
      "asyncio",
      "logging",
      "time",
      "src.core.instruction_manager",
      "src.workflow.executor"
    ],
    "style": {
      "coding_standard": "PEP 8準拠",
      "docstring": "Google Style",
      "type_hints": "必須",
      "comments": "複雑なロジックには日本語コメント"
    },
    "test_cases": [
      {
        "name": "少数命令書の一括実行",
        "input": {
          "instruction_ids": [
            "id1",
            "id2"
          ],
          "operation": "execute",
          "parallel": false
        },
        "expected_output": {
          "success": 2,
          "failed": 0,
          "details": [
            {
              "id": "id1",
              "status": "success"
            },
            {
              "id": "id2",
              "status": "success"
            }
          ],
          "total_time": 5.2
        },
        "description": "少数の命令書を順次実行するテスト"
      },
      {
        "name": "無効な命令書IDを含むバッチ",
        "input": {
          "instruction_ids": [
            "valid_id",
            "invalid_id"
          ],
          "operation": "execute",
          "parallel": true
        },
        "expected_output": {
          "success": 1,
          "failed": 1,
          "details": [
            {
              "id": "valid_id",
              "status": "success"
            },
            {
              "id": "invalid_id",
              "status": "error",
              "error": "instruction not found"
            }
          ],
          "total_time": 2.1
        },
        "description": "無効なIDを含む場合のエラーハンドリングテスト"
      }
    ],
    "performance": {
      "complexity": "O(n) - nは命令書数、並列処理では実質的にO(1)",
      "memory": "並列処理数×命令書サイズのメモリ使用量",
      "benchmarks": "100件の命令書を並列での60秒以内処理"
    },
    "security": {
      "input_sanitization": "instruction_idの形式検証、SQLインジェクション等の防止",
      "data_protection": "命令書データの暗号化、ログからの機密情報除外",
      "access_control": "バッチ処理実行権限の確認、管理者のみアクセス可能"
    }
  },
  "status": "executed",
  "created_at": "2025-09-06T15:46:49.321419",
  "updated_at": "2025-09-06T16:17:39.254151",
  "approved_at": "2025-09-06T16:00:00",
  "approved_by": "Claude Code - Phase 4継続作業",
  "version": 1,
  "hash": "7ae00b8f58343521",
  "review_comments": []
}